# FaceSR-GAN ‚Äî Super-Resolution of Facial Images with GANs üß†üñºÔ∏è

## Overview
**FaceSR-GAN** is a deep learning project built from scratch to upscale low-resolution facial images back into high-resolution versions. The core goal is to create a Generative Adversarial Network (GAN) that enhances facial images from 64√ó64 pixels to 256√ó256 pixels, reconstructing details and features lost in the low-resolution version.

We use [CelebA](https://www.kaggle.com/datasets/jessicali9530/celeba-dataset), a large-scale dataset of celebrity faces. Each image is processed in two versions:
- **Low-resolution input**: 64√ó64 pixel facial images
- **High-resolution target**: 256√ó256 pixel facial images with clear details

## Network Architecture Evolution
Our GAN architecture evolved through several iterations, each with unique trade-offs:

1. **Upsample-based Generator**:
   - **Pros**: Fast training convergence
   - **Cons**: High memory consumption, detail preservation issues, training instability
   - **Results**: Quick but lower quality outputs with limited facial detail reconstruction

2. **PixelShuffle Implementation**:
   - **Pros**: More realistic image generation, significantly reduced memory footprint, flexible generator scaling
   - **Cons**: Longer training cycles, though still reasonable
   - **Results**: Improved output quality with better facial feature preservation

3. **ResidualBlock with Attention**:
   - **Pros**: Minimal memory usage, highly stable training dynamics
   - **Cons**: Slower training convergence
   - **Results**: Lower initial quality but promising architecture that would likely excel with extended training time

This evolutionary approach allowed us to understand the trade-offs between different super-resolution techniques in the context of facial image enhancement.

## Generator models note

Our generator architecture evolved across versions to explore different capacity and feature extraction approaches:

### Generator v1
The initial generator used a straightforward approach with PixelShuffle for upsampling:
- 7 convolutional layers with gradually decreasing channel dimensions (3‚Üí128‚Üí512‚Üí128‚Üí256‚Üí128‚Üí64‚Üí3)
- PixelShuffle upsampling (2√ó) after the second and third layers
- Instance normalization and ReLU activation throughout the network
- Final Tanh activation for normalized output

### Generator v2
The enhanced generator modified the architecture with different channel allocations:
- 8 convolutional layers with a different channel progression (3‚Üí128‚Üí512‚Üí128‚Üí384‚Üí128‚Üí128‚Üí32‚Üí3)
- Same PixelShuffle upsampling strategy as v1
- Added an additional refinement layer (conv7) before final output
- Higher capacity in middle layers (384 vs 256 channels)
- More balanced feature reduction toward the output

### Performance of generators
It's important to note that v2 isn't necessarily always better than v1 in all scenarios:

- **v1 Advantages**: More straightforward channel reduction may provide better convergence for some datasets; fewer parameters can lead to faster training and inference; simpler architecture may generalize better with limited training data.

- **v2 Advantages**: Additional layer provides more capacity for learning complex features; different channel allocations may capture certain facial details better; modified architecture might handle certain image characteristics more effectively.

The optimal choice between these architectures depends on specific requirements, dataset characteristics, and computational constraints. Our experiments showed that both architectures have merit in different contexts, highlighting the importance of architecture experimentation in GAN development.

## Results
Below are some of the best-performing examples generated by our FaceSR-GAN model.

![image](https://github.com/user-attachments/assets/58c4b2ce-5adb-492f-8e5e-e90cae84fc2c)
![image](https://github.com/user-attachments/assets/3a74d01f-d0b5-4e2f-a877-c3505958cd6c)
![image](https://github.com/user-attachments/assets/15d43d23-bf01-4999-9951-45bb21a98f07)
![image](https://github.com/user-attachments/assets/fc55b949-fec0-4e2e-88f3-9941e75387be)



## Setup & Installation
To run the project locally, we use [`uv`](https://github.com/astral-sh/uv) for clean, reproducible Python environments:

1. **Install `uv`:**
   - On macOS / Linux:
     ```bash
     curl -LsSf https://astral.sh/uv/install.sh | sh
     ```
   - On Windows:
     ```powershell
     powershell -ExecutionPolicy ByPass -c "irm https://astral.sh/uv/install.ps1 | iex"
     ```

2. **Install dependencies and PyTorch:**
   ```bash
   uv sync
   uv pip install torch torchvision --index-url https://download.pytorch.org/whl/cu118
   ```

3. **Clone the repository:**
   ```bash
   git clone https://github.com/wiktorlewandowski9/FaceSR-GAN.git
   cd FaceSR-GAN
   ```

